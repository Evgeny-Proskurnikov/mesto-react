(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{14:function(e,t,a){},15:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(5),c=a.n(r),l=(a(14),a(8)),i=a(1);var s=function(){return o.a.createElement("header",{className:"header"},o.a.createElement("div",{className:"header__logo"}))},u=o.a.createContext(),m={name:"",about:"",avatar:"",_id:""};var d=function(e){var t=e.card,a=e.onCardClick,n=e.onCardLike,r=e.onCardDelete,c=o.a.useContext(u),l=t.owner._id===c._id,i=t.likes.some((function(e){return e._id===c._id})),s="".concat(i?"card__like-button card__like-button_status_active":"card__like-button");return o.a.createElement("div",{className:"card"},l&&o.a.createElement("button",{type:"button",className:"card__delete-button",onClick:function(){r(t)}}),o.a.createElement("img",{src:t?t.link:"",alt:t?t.name:"",className:"card__image",onClick:function(){a(t)}}),o.a.createElement("div",{className:"card__conteiner"},o.a.createElement("h2",{className:"card__title"},t?t.name:""),o.a.createElement("button",{type:"button",className:s,onClick:function(){n(t)}},o.a.createElement("span",{className:"card__like-counter"},t&&t.likes.length>0?t.likes.length:null))))};var _=function(e){var t=e.onEditProfile,a=e.onAddPlace,n=e.onEditAvatar,r=e.onCardClick,c=e.cards,l=e.onCardLike,i=e.onCardDelete,s=o.a.useContext(u);return o.a.createElement("main",{className:"content"},o.a.createElement("section",{className:"profile"},o.a.createElement("div",{className:"profile__overlay",onClick:n},o.a.createElement("img",{src:s.avatar,alt:"\u0410\u0432\u0430\u0442\u0430\u0440",className:"profile__avatar"})),o.a.createElement("div",{className:"profile__info"},o.a.createElement("h1",{className:"profile__name"},s.name),o.a.createElement("button",{type:"button",className:"profile__edit-button",onClick:t}),o.a.createElement("p",{className:"profile__character"},s.about)),o.a.createElement("button",{type:"button",className:"profile__add-button",onClick:a})),o.a.createElement("section",{className:"elements"},c.map((function(e){return o.a.createElement(d,{card:e,key:e._id,onCardClick:r,onCardLike:l,onCardDelete:i})}))))};var p=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))};var f=function(e){var t=e.name,a=e.modalState,n=e.title,r=e.containerClass,c=e.onClose,l=e.children;return o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"modal modal_type_".concat(t," ").concat(a)},o.a.createElement("div",{className:"modal__container ".concat(r)},o.a.createElement("button",{type:"button",className:"modal__close-button",onClick:c}),o.a.createElement("h3",{className:"modal__title"},n),l)))};var h=function(e){var t=e.card,a=e.modalState,n=e.onClose;return o.a.createElement("div",{className:"modal modal_type_photo ".concat(a)},o.a.createElement("div",{className:"modal__container modal__conteiner_type_photo"},o.a.createElement("button",{type:"button",className:"modal__close-button",onClick:n}),o.a.createElement("img",{src:t?t.link:"#",alt:t?t.name:"",className:"modal__image"}),o.a.createElement("h3",{className:"modal__title modal__title_type_photo"},t?t.name:"")))},v=a(6),E=a(7),C=new(function(){function e(t){Object(v.a)(this,e),this._url=t.url,this._token=t.token}return Object(E.a)(e,[{key:"getInitialCards",value:function(){return fetch("".concat(this._url,"/cards"),{method:"GET",headers:{authorization:this._token,"Content-type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._url,"/users/me"),{method:"GET",headers:{authorization:this._token,"Content-type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"postCard",value:function(e){return fetch("".concat(this._url,"/cards"),{method:"POST",headers:{authorization:this._token,"Content-type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"delCard",value:function(e){return fetch("".concat(this._url,"/cards/").concat(e),{method:"DELETE",headers:{authorization:this._token,"Content-type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"saveUserInfo",value:function(e){return fetch("".concat(this._url,"/users/me"),{method:"PATCH",headers:{authorization:this._token,"Content-type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"saveAvatar",value:function(e){return fetch("".concat(this._url,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._token,"Content-type":"application/json"},body:JSON.stringify(e)}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"changeLikeCardStatus",value:function(e,t){return fetch("".concat(this._url,"/cards/likes/").concat(e),{method:t?"DELETE":"PUT",headers:{authorization:this._token,"Content-type":"application/json"}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}}]),e}())({url:"https://mesto.nomoreparties.co/v1/cohort-15",token:"06e1dc17-91d9-4de2-856b-fec4fd742305"});var k=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateUser,r=o.a.useContext(u),c=o.a.useState(""),l=Object(i.a)(c,2),s=l[0],m=l[1],d=o.a.useState(""),_=Object(i.a)(d,2),p=_[0],h=_[1];return o.a.useEffect((function(){m(r.name),h(r.about)}),[r]),o.a.createElement(f,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit-profile",modalState:t?"modal_opened":"",onClose:a,children:o.a.createElement("form",{action:"#",name:"edit-profile",className:"modal__form modal__form_type_profile",onSubmit:function(e){e.preventDefault(),n({name:s,about:p})},noValidate:!0},o.a.createElement("input",{id:"name-input",name:"name",type:"text",className:"modal__input modal__input_type_name",value:s,onChange:function(e){m(e.target.value)},placeholder:"\u0418\u043c\u044f",required:!0,minLength:"2",maxLength:"40",autoComplete:"off"}),o.a.createElement("span",{id:"name-input-error",className:"modal__input-error"}),o.a.createElement("input",{id:"character-input",name:"about",type:"text",className:"modal__input modal__input_type_character",value:p,onChange:function(e){h(e.target.value)},placeholder:"\u0417\u0430\u043d\u044f\u0442\u0438\u0435",required:!0,minLength:"2",maxLength:"200",autoComplete:"off"}),o.a.createElement("span",{id:"character-input-error",className:"modal__input-error"}),o.a.createElement("button",{type:"submit",className:"modal__save-button"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))})};var b=function(e){var t=e.isOpen,a=e.onClose,n=e.onUpdateAvatar,r=o.a.useRef();return o.a.createElement(f,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"edit-avatar",modalState:t?"modal_opened":"",onClose:a,children:o.a.createElement("form",{action:"#",name:"edit-avatar",className:"modal__form modal__form_type_avatar",onSubmit:function(e){e.preventDefault(),n({avatar:r.current.value})},noValidate:!0},o.a.createElement("input",{id:"url-input",name:"avatar",type:"url",className:"modal__input modal__input_type_link",ref:r,onChange:function(e){r.current.value=e.target.value},placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",required:!0,minLength:"2",maxLength:"200",autoComplete:"off"}),o.a.createElement("span",{id:"url-input-error",className:"modal__input-error"}),o.a.createElement("button",{type:"submit",className:"modal__save-button"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))})};var y=function(e){var t=e.isOpen,a=e.onClose,n=e.onAddPlace,r=o.a.useState(""),c=Object(i.a)(r,2),l=c[0],s=c[1],u=o.a.useState(""),m=Object(i.a)(u,2),d=m[0],_=m[1];return o.a.createElement(f,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add-card",modalState:t?"modal_opened":"",onClose:a,children:o.a.createElement("form",{action:"#",name:"add-card",className:"modal__form modal__form_type_addcard",onSubmit:function(e){e.preventDefault(),n({name:l,link:d})},noValidate:!0},o.a.createElement("input",{id:"place-input",name:"name",type:"text",className:"modal__input modal__input_type_place",value:l,onChange:function(e){s(e.target.value)},placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",required:!0,minLength:"1",maxLength:"30",autoComplete:"off"}),o.a.createElement("span",{id:"place-input-error",className:"modal__input-error"}),o.a.createElement("input",{id:"url-input",name:"link",type:"url",className:"modal__input modal__input_type_link",value:d,onChange:function(e){_(e.target.value)},placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0,minLength:"2",maxLength:"200",autoComplete:"off"}),o.a.createElement("span",{id:"url-input-error",className:"modal__input-error"}),o.a.createElement("button",{type:"submit",className:"modal__save-button"},"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"))})},g=o.a.createContext();var N=function(){var e=o.a.useState(!1),t=Object(i.a)(e,2),a=t[0],n=t[1],r=o.a.useState(!1),c=Object(i.a)(r,2),d=c[0],v=c[1],E=o.a.useState(!1),N=Object(i.a)(E,2),j=N[0],S=N[1],O=o.a.useState({link:""}),P=Object(i.a)(O,2),L=P[0],x=P[1],A=o.a.useState(m),U=Object(i.a)(A,2),w=U[0],D=U[1],T=o.a.useState([]),z=Object(i.a)(T,2),I=z[0],q=z[1];function J(){v(!1),n(!1),S(!1),x({link:""})}return o.a.useEffect((function(){Promise.all([C.getUserInfo(),C.getInitialCards()]).then((function(e){var t=Object(i.a)(e,2),a=t[0],n=t[1];D(a),q(n)})).catch((function(e){console.log(e)}))}),[]),o.a.createElement(u.Provider,{value:w},o.a.createElement(g.Provider,{value:I},o.a.createElement("div",{className:"page"},o.a.createElement(s,null),o.a.createElement(_,{onEditProfile:function(){n(!0)},onAddPlace:function(){v(!0)},onEditAvatar:function(){S(!0)},onCardClick:function(e){x(e)},cards:I,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===w._id}));C.changeLikeCardStatus(e._id,t).then((function(t){var a=I.map((function(a){return a._id===e._id?t:a}));q(a)})).catch((function(e){console.log(e)}))},onCardDelete:function(e){C.delCard(e._id).then((function(){var t=I.filter((function(t){return t._id!==e._id}));q(t)})).catch((function(e){console.log(e)}))}}),o.a.createElement(p,null),o.a.createElement(k,{isOpen:a,onClose:J,onUpdateUser:function(e){C.saveUserInfo(e).then((function(e){D(e)})).catch((function(e){console.log(e)})).finally((function(){n(!1)}))}}),o.a.createElement(y,{isOpen:d,onClose:J,onAddPlace:function(e){C.postCard(e).then((function(e){q([e].concat(Object(l.a)(I)))})).catch((function(e){console.log(e)})).finally((function(){v(!1)}))}}),o.a.createElement(b,{isOpen:j,onClose:J,onUpdateAvatar:function(e){C.saveAvatar(e).then((function(e){D(e)})).catch((function(e){console.log(e)})).finally((function(){S(!1)}))}}),o.a.createElement(f,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"del-card",children:o.a.createElement("button",{type:"button",className:"modal__confirm-button"},"\u0414\u0430")}),o.a.createElement(f,{title:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a...",name:"error",containerClass:"modal__conteiner_type_error"}),o.a.createElement(h,{card:L,modalState:L.link&&"modal_opened",onClose:J}))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(N,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},9:function(e,t,a){e.exports=a(15)}},[[9,1,2]]]);
//# sourceMappingURL=main.e711070e.chunk.js.map